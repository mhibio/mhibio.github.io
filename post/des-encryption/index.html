<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Des-Encryption.c | mhibio</title>
  <meta name="description" content="Hi">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Des-Encryption.c" />
<meta property="og:description" content="While I was studying cryptography, I suddenly thought of it.
so I implemented it in c.
Only 8 bytes can be encrypted.
Operational modes such as ecb and cbc will be implemented later.
 My coding skills are really the worst.
I hope you understand if you&rsquo;re upset by my code.
I referred to the tables at https://dreamhack.io.
Des-Encryption.c #include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;stdint.h&gt; #define BUF_SIZE 10  uint64_t bitarray2integer(char bitarray[], int leng); void key_generation(char result[][48], char bitarray[]); void char2bitarray(char bitarray[], char *buf); void ROL_ARRAY(char array[], unsigned int rotation, int size); void permutation(char result[], char bitarray[], const char table[], int leng); void bitdump(char bitarray[], int leng); char *round_f(char result[], char bitarray[], char roundkey[]); const char IPT[64] = { 58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7 }; const char FPT[64] = { 40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25 }; // Expansion P-Box Table const char EPT[48] = { 32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13, 14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24, 25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1 }; // S-Boxs const char SBOX[8][4][16] = { // S1  { {14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7}, {0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8}, {4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0}, {15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13} }, // S2  { {15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10}, {3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5}, {0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15}, {13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9}, }, // S3  { {10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8}, {13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1}, {13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7}, {1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12}, }, // S4  { {7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15}, {13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9}, {10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4}, {3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14}, }, // S5  { {2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9}, {14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6}, {4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14}, {11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3}, }, // S6  { {12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11}, {10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8}, {9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6}, {4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13}, }, // S7  { {4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1}, {13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6}, {1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2}, {6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12}, }, // S8  { {13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7}, {1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2}, {7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8}, {2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11}, } }; // Straight P-Box Table const char SPT[32] = { 16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25 }; // Parity Bit Drop Table const char PBDT[56] = { 57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4 }; // Compression P-Box Table const char CPBT[48] = { 14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32 }; // 1, 2, 9, 16 =&gt; ROL(1) // else =&gt; ROL(2) const char shifting[16] = { 1 ,1 ,2 ,2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 }; void permutation(char result[], char bitarray[], const char table[], int length) { for(int i = 0; i &lt; length; i&#43;&#43;) { result[i] = bitarray[table[i]-1]; } } void key_generation(char result[][48], char bitarray[]) { char pc1_result[56] = {0, }; char concat[48] = {0, }; char left[28], right[28]; // Parity Drop and Permutation  permutation(pc1_result, bitarray, PBDT, 56); for(int n1 = 0; n1 &lt; 28; n1&#43;&#43;) left[n1] = pc1_result[n1]; for(int n2 = 28; n2 &lt; 56; n2&#43;&#43;) right[n2-28] = pc1_result[n2]; for(int i = 0; i &lt; 16; i&#43;&#43;) { ROL_ARRAY(left, shifting[i], 28); ROL_ARRAY(right, shifting[i], 28); for(int n1 = 0; n1 &lt; 28; n1&#43;&#43;) { concat[n1] = left[n1]; concat[n1&#43;28] = right[n1]; } // Compression P-box  permutation(result[i], concat, CPBT, 48); } } uint64_t bitarray2integer(char bitarray[], int leng) { uint64_t result = 0; for(int i = 0; i &lt; leng; i&#43;&#43;) result |= ( (uint64_t)bitarray[i] &lt;&lt; (leng-i-1) ); return result; } void char2bitarray(char bitarray[], char *buf) { for(int i = 0; i &lt; 64; i&#43;&#43;) { bitarray[(8 * (i/8)) &#43; 7-(i % 8)] = (buf[i / 8] &amp; (1 &lt;&lt; (i % 8))) &gt;&gt; (i % 8); } } void bitdump(char bitarray[], int leng) { printf(&#34;[&#43;] BITDUMP : &#34;); for(int i = 0; i &lt; leng; i&#43;&#43;) printf(&#34;%d&#34;, bitarray[i]); printf(&#34;\n&#34;); } void ROL_ARRAY(char array[], unsigned int rotation, int size) { char tmp = 0; for(int i = 0; i &lt; rotation; i&#43;&#43;) { tmp = array[0]; for(int j = 0; j &lt; size-1; j&#43;&#43;) array[j] = array[j&#43;1]; array[size-1] = tmp; } } char* round_f(char result[], char bitarray[], char roundkey[]) { char extend_bitarray[48] = {0, }; char temp_bitarray[32] = {0, }; char sbox_calc[6] = {0, }; char row, col, val; permutation(extend_bitarray, bitarray, EPT, 48); for(int i = 0; i &lt; 48; i&#43;&#43;) extend_bitarray[i] ^= roundkey[i]; for(int i = 0; i &lt; 8; i&#43;&#43;) { memcpy(sbox_calc, &amp;extend_bitarray[i*6], 6); row = (sbox_calc[0] &lt;&lt; 1) &#43; sbox_calc[5]; col = (sbox_calc[1] &lt;&lt; 3) &#43; (sbox_calc[2] &lt;&lt; 2) &#43; (sbox_calc[3] &lt;&lt; 1) &#43; sbox_calc[4]; val = SBOX[i][row][col]; for(int j = 0; j &lt; 4; j&#43;&#43;) temp_bitarray[i*4 &#43; j] = (val &gt;&gt; (3-j)) &amp; 1; } permutation(result, temp_bitarray, SPT, 32); } int main() { char *buf = malloc(BUF_SIZE); char *key = malloc(BUF_SIZE); char left[32], right[32], tmp[32], round_result[32]; char buf_bitarray[64] = {0, }; char key_bitarray[64] = {0, }; char ip_array[64] = {0, }; char result[64] = {0, }; char round_key[16][48] = {0, }; printf(&#34;Input Message ( 8 Bytes ): &#34;); fgets(buf, BUF_SIZE, stdin); buf[strlen(buf) - 1] = &#39;\0&#39;; char2bitarray(buf_bitarray, buf); printf(&#34;Input Key ( 8 Bytes ): &#34;); fgets(key, BUF_SIZE, stdin); key[strlen(key) - 1] = &#39;\0&#39;; char2bitarray(key_bitarray, key); // initial permutation  permutation(ip_array, buf_bitarray, IPT, 64); key_generation(round_key, key_bitarray); memcpy(left, ip_array, 32); memcpy(right, &amp;ip_array[32], 32); for(int i = 0; i &lt; 16; i&#43;&#43;) { round_f(round_result, right, round_key[i]); for(int n = 0; n &lt; 32; n&#43;&#43;) { left[n] ^= round_result[n]; } memcpy(tmp, left, 32); memcpy(left, right, 32); memcpy(right, tmp, 32); } memcpy(ip_array, right, 32); memcpy(&amp;ip_array[32], left, 32); // final permutation  permutation(result, ip_array, FPT, 64); printf(&#34;Encrypted : %lu\n&#34;, bitarray2integer(result, 64)); printf(&#34;hex(Encrypted) : %lx&#34;, bitarray2integer(result, 64)); return 0; } To improve algorithm skills and coding skills, I will implement several Encryption scheme, such as aes, in c." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mhibio.github.io/post/des-encryption/" />
<meta property="article:published_time" content="2021-05-12T19:48:02+09:00" />
<meta property="article:modified_time" content="2021-05-12T19:48:02+09:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Des-Encryption.c"/>
<meta name="twitter:description" content="While I was studying cryptography, I suddenly thought of it.
so I implemented it in c.
Only 8 bytes can be encrypted.
Operational modes such as ecb and cbc will be implemented later.
 My coding skills are really the worst.
I hope you understand if you&rsquo;re upset by my code.
I referred to the tables at https://dreamhack.io.
Des-Encryption.c #include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;stdint.h&gt; #define BUF_SIZE 10  uint64_t bitarray2integer(char bitarray[], int leng); void key_generation(char result[][48], char bitarray[]); void char2bitarray(char bitarray[], char *buf); void ROL_ARRAY(char array[], unsigned int rotation, int size); void permutation(char result[], char bitarray[], const char table[], int leng); void bitdump(char bitarray[], int leng); char *round_f(char result[], char bitarray[], char roundkey[]); const char IPT[64] = { 58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7 }; const char FPT[64] = { 40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25 }; // Expansion P-Box Table const char EPT[48] = { 32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13, 14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24, 25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1 }; // S-Boxs const char SBOX[8][4][16] = { // S1  { {14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7}, {0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8}, {4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0}, {15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13} }, // S2  { {15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10}, {3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5}, {0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15}, {13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9}, }, // S3  { {10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8}, {13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1}, {13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7}, {1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12}, }, // S4  { {7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15}, {13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9}, {10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4}, {3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14}, }, // S5  { {2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9}, {14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6}, {4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14}, {11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3}, }, // S6  { {12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11}, {10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8}, {9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6}, {4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13}, }, // S7  { {4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1}, {13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6}, {1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2}, {6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12}, }, // S8  { {13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7}, {1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2}, {7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8}, {2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11}, } }; // Straight P-Box Table const char SPT[32] = { 16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25 }; // Parity Bit Drop Table const char PBDT[56] = { 57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4 }; // Compression P-Box Table const char CPBT[48] = { 14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32 }; // 1, 2, 9, 16 =&gt; ROL(1) // else =&gt; ROL(2) const char shifting[16] = { 1 ,1 ,2 ,2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 }; void permutation(char result[], char bitarray[], const char table[], int length) { for(int i = 0; i &lt; length; i&#43;&#43;) { result[i] = bitarray[table[i]-1]; } } void key_generation(char result[][48], char bitarray[]) { char pc1_result[56] = {0, }; char concat[48] = {0, }; char left[28], right[28]; // Parity Drop and Permutation  permutation(pc1_result, bitarray, PBDT, 56); for(int n1 = 0; n1 &lt; 28; n1&#43;&#43;) left[n1] = pc1_result[n1]; for(int n2 = 28; n2 &lt; 56; n2&#43;&#43;) right[n2-28] = pc1_result[n2]; for(int i = 0; i &lt; 16; i&#43;&#43;) { ROL_ARRAY(left, shifting[i], 28); ROL_ARRAY(right, shifting[i], 28); for(int n1 = 0; n1 &lt; 28; n1&#43;&#43;) { concat[n1] = left[n1]; concat[n1&#43;28] = right[n1]; } // Compression P-box  permutation(result[i], concat, CPBT, 48); } } uint64_t bitarray2integer(char bitarray[], int leng) { uint64_t result = 0; for(int i = 0; i &lt; leng; i&#43;&#43;) result |= ( (uint64_t)bitarray[i] &lt;&lt; (leng-i-1) ); return result; } void char2bitarray(char bitarray[], char *buf) { for(int i = 0; i &lt; 64; i&#43;&#43;) { bitarray[(8 * (i/8)) &#43; 7-(i % 8)] = (buf[i / 8] &amp; (1 &lt;&lt; (i % 8))) &gt;&gt; (i % 8); } } void bitdump(char bitarray[], int leng) { printf(&#34;[&#43;] BITDUMP : &#34;); for(int i = 0; i &lt; leng; i&#43;&#43;) printf(&#34;%d&#34;, bitarray[i]); printf(&#34;\n&#34;); } void ROL_ARRAY(char array[], unsigned int rotation, int size) { char tmp = 0; for(int i = 0; i &lt; rotation; i&#43;&#43;) { tmp = array[0]; for(int j = 0; j &lt; size-1; j&#43;&#43;) array[j] = array[j&#43;1]; array[size-1] = tmp; } } char* round_f(char result[], char bitarray[], char roundkey[]) { char extend_bitarray[48] = {0, }; char temp_bitarray[32] = {0, }; char sbox_calc[6] = {0, }; char row, col, val; permutation(extend_bitarray, bitarray, EPT, 48); for(int i = 0; i &lt; 48; i&#43;&#43;) extend_bitarray[i] ^= roundkey[i]; for(int i = 0; i &lt; 8; i&#43;&#43;) { memcpy(sbox_calc, &amp;extend_bitarray[i*6], 6); row = (sbox_calc[0] &lt;&lt; 1) &#43; sbox_calc[5]; col = (sbox_calc[1] &lt;&lt; 3) &#43; (sbox_calc[2] &lt;&lt; 2) &#43; (sbox_calc[3] &lt;&lt; 1) &#43; sbox_calc[4]; val = SBOX[i][row][col]; for(int j = 0; j &lt; 4; j&#43;&#43;) temp_bitarray[i*4 &#43; j] = (val &gt;&gt; (3-j)) &amp; 1; } permutation(result, temp_bitarray, SPT, 32); } int main() { char *buf = malloc(BUF_SIZE); char *key = malloc(BUF_SIZE); char left[32], right[32], tmp[32], round_result[32]; char buf_bitarray[64] = {0, }; char key_bitarray[64] = {0, }; char ip_array[64] = {0, }; char result[64] = {0, }; char round_key[16][48] = {0, }; printf(&#34;Input Message ( 8 Bytes ): &#34;); fgets(buf, BUF_SIZE, stdin); buf[strlen(buf) - 1] = &#39;\0&#39;; char2bitarray(buf_bitarray, buf); printf(&#34;Input Key ( 8 Bytes ): &#34;); fgets(key, BUF_SIZE, stdin); key[strlen(key) - 1] = &#39;\0&#39;; char2bitarray(key_bitarray, key); // initial permutation  permutation(ip_array, buf_bitarray, IPT, 64); key_generation(round_key, key_bitarray); memcpy(left, ip_array, 32); memcpy(right, &amp;ip_array[32], 32); for(int i = 0; i &lt; 16; i&#43;&#43;) { round_f(round_result, right, round_key[i]); for(int n = 0; n &lt; 32; n&#43;&#43;) { left[n] ^= round_result[n]; } memcpy(tmp, left, 32); memcpy(left, right, 32); memcpy(right, tmp, 32); } memcpy(ip_array, right, 32); memcpy(&amp;ip_array[32], left, 32); // final permutation  permutation(result, ip_array, FPT, 64); printf(&#34;Encrypted : %lu\n&#34;, bitarray2integer(result, 64)); printf(&#34;hex(Encrypted) : %lx&#34;, bitarray2integer(result, 64)); return 0; } To improve algorithm skills and coding skills, I will implement several Encryption scheme, such as aes, in c."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://mhibio.github.io/css/style-dark.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://mhibio.github.io">
    
  <div id="title">
    <h1>mhibio</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/post">Writings</a></li>
      
        <li><a href="/whoami">About</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <p>While I was studying cryptography, I suddenly thought of it.<br>
so I implemented it in c.</p>
<p>Only <code>8 bytes</code> can be encrypted.<br>
Operational modes such as <code>ecb</code> and <code>cbc</code> will be implemented later.</p>
<!-- raw HTML omitted -->
<hr>
<!-- raw HTML omitted -->
<p><strong>My coding skills are really the worst.</strong><br>
<strong>I hope you understand if you&rsquo;re upset by my code.</strong></p>
<p><strong>I referred to the tables at <a href="https://dreamhack.io">https://dreamhack.io</a>.</strong></p>
<h2 id="des-encryptionc">Des-Encryption.c</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#define BUF_SIZE 10
</span><span style="color:#75715e"></span>
uint64_t <span style="color:#a6e22e">bitarray2integer</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">int</span> leng);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">key_generation</span>(<span style="color:#66d9ef">char</span> result[][<span style="color:#ae81ff">48</span>], <span style="color:#66d9ef">char</span> bitarray[]);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">char2bitarray</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ROL_ARRAY</span>(<span style="color:#66d9ef">char</span> array[], <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> rotation, <span style="color:#66d9ef">int</span> size);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">permutation</span>(<span style="color:#66d9ef">char</span> result[], <span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> table[], <span style="color:#66d9ef">int</span> leng);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bitdump</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">int</span> leng);
<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">round_f</span>(<span style="color:#66d9ef">char</span> result[], <span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">char</span> roundkey[]);

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> IPT[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {
	<span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,
    <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,
    <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,
    <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>,
    <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,
    <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,
    <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,
    <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>
};

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> FPT[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {
	<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">32</span>,
    <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">31</span>,
    <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">30</span>,
    <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">29</span>,
    <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">28</span>,
    <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">27</span>,
    <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">26</span>,
    <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">25</span>
};

<span style="color:#75715e">// Expansion P-Box Table
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> EPT[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> {
	<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>,
    <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>,
    <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>,
    <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>,
    <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>,
    <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>,
    <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>,
    <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>
};

<span style="color:#75715e">// S-Boxs
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> SBOX[<span style="color:#ae81ff">8</span>][<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> {
    <span style="color:#75715e">// S1
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>},
        {<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>},
        {<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>},
        {<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>}
    },
    <span style="color:#75715e">// S2
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">10</span>},
        {<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>},
        {<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">15</span>},
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>},
    },
    <span style="color:#75715e">// S3
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>},
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>},
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>},
        {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>},
    },
    <span style="color:#75715e">// S4
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>},
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>},
        {<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>},
        {<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>},
    },
    <span style="color:#75715e">// S5
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>},
        {<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>},
        {<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>},
        {<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>},
    },
    <span style="color:#75715e">// S6
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>},
        {<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>},
        {<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>},
        {<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">13</span>},
    },
    <span style="color:#75715e">// S7
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>},
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>},
        {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>},
        {<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>},
    },
    <span style="color:#75715e">// S8
</span><span style="color:#75715e"></span>    {
        {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>},
        {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>},
        {<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>},
        {<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>},
    }
};

<span style="color:#75715e">// Straight P-Box Table
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> SPT[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> { 
	<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">17</span>,
    <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">10</span>,
    <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>,
    <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">25</span>
};

<span style="color:#75715e">// Parity Bit Drop Table
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> PBDT[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> {
	<span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">18</span>,
	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">27</span>,
	<span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">36</span>,
	<span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">15</span>,
	<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">22</span>,
	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">29</span>,
	<span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>
};

<span style="color:#75715e">// Compression P-Box Table
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> CPBT[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> {
	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">28</span>,
	<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,
	<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>,
	<span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>,
	<span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">56</span>,
	<span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">32</span>
};

<span style="color:#75715e">// 1, 2, 9, 16 =&gt; ROL(1) 
</span><span style="color:#75715e">// else =&gt; ROL(2)
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> shifting[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">1</span> ,<span style="color:#ae81ff">1</span> ,<span style="color:#ae81ff">2</span> ,<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span> };

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">permutation</span>(<span style="color:#66d9ef">char</span> result[], <span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> table[], <span style="color:#66d9ef">int</span> length) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
        result[i] <span style="color:#f92672">=</span> bitarray[table[i]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">key_generation</span>(<span style="color:#66d9ef">char</span> result[][<span style="color:#ae81ff">48</span>], <span style="color:#66d9ef">char</span> bitarray[]) {
    <span style="color:#66d9ef">char</span> pc1_result[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> concat[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> left[<span style="color:#ae81ff">28</span>], right[<span style="color:#ae81ff">28</span>];

    <span style="color:#75715e">// Parity Drop and Permutation
</span><span style="color:#75715e"></span>    permutation(pc1_result, bitarray, PBDT, <span style="color:#ae81ff">56</span>);

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; n1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">28</span>; n1<span style="color:#f92672">++</span>) left[n1] <span style="color:#f92672">=</span> pc1_result[n1];
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>; n2 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">56</span>; n2<span style="color:#f92672">++</span>) right[n2<span style="color:#f92672">-</span><span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> pc1_result[n2];

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
        ROL_ARRAY(left, shifting[i], <span style="color:#ae81ff">28</span>);
        ROL_ARRAY(right, shifting[i], <span style="color:#ae81ff">28</span>);
        
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; n1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">28</span>; n1<span style="color:#f92672">++</span>) {
            concat[n1] <span style="color:#f92672">=</span> left[n1];
            concat[n1<span style="color:#f92672">+</span><span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> right[n1];
        }

        <span style="color:#75715e">// Compression P-box
</span><span style="color:#75715e"></span>        permutation(result[i], concat, CPBT, <span style="color:#ae81ff">48</span>);
    }
}

uint64_t <span style="color:#a6e22e">bitarray2integer</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">int</span> leng) {
    uint64_t result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> leng; i<span style="color:#f92672">++</span>) 
        result <span style="color:#f92672">|=</span> ( (uint64_t)bitarray[i] <span style="color:#f92672">&lt;&lt;</span> (leng<span style="color:#f92672">-</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) );
    <span style="color:#66d9ef">return</span> result;
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">char2bitarray</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {
        bitarray[(<span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> (i<span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>)) <span style="color:#f92672">+</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>(i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>)] <span style="color:#f92672">=</span> (buf[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>))) <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>);
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bitdump</span>(<span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">int</span> leng) {
    printf(<span style="color:#e6db74">&#34;[+] BITDUMP : &#34;</span>);
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> leng; i<span style="color:#f92672">++</span>)
        printf(<span style="color:#e6db74">&#34;%d&#34;</span>, bitarray[i]);
    printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ROL_ARRAY</span>(<span style="color:#66d9ef">char</span> array[], <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> rotation, <span style="color:#66d9ef">int</span> size) {
    <span style="color:#66d9ef">char</span> tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> rotation; i<span style="color:#f92672">++</span>) {
        tmp <span style="color:#f92672">=</span> array[<span style="color:#ae81ff">0</span>];
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> size<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; j<span style="color:#f92672">++</span>) 
            array[j] <span style="color:#f92672">=</span> array[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
        array[size<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> tmp;
    }   
}

<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">round_f</span>(<span style="color:#66d9ef">char</span> result[], <span style="color:#66d9ef">char</span> bitarray[], <span style="color:#66d9ef">char</span> roundkey[]) {
    <span style="color:#66d9ef">char</span> extend_bitarray[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> temp_bitarray[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> sbox_calc[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> row, col, val;

    permutation(extend_bitarray, bitarray, EPT, <span style="color:#ae81ff">48</span>);

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">48</span>; i<span style="color:#f92672">++</span>)
        extend_bitarray[i] <span style="color:#f92672">^=</span> roundkey[i];

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {
        memcpy(sbox_calc, <span style="color:#f92672">&amp;</span>extend_bitarray[i<span style="color:#f92672">*</span><span style="color:#ae81ff">6</span>], <span style="color:#ae81ff">6</span>);
        row <span style="color:#f92672">=</span> (sbox_calc[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> sbox_calc[<span style="color:#ae81ff">5</span>];   
        col <span style="color:#f92672">=</span> (sbox_calc[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> (sbox_calc[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (sbox_calc[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> sbox_calc[<span style="color:#ae81ff">4</span>];
        val <span style="color:#f92672">=</span> SBOX[i][row][col];

        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; j<span style="color:#f92672">++</span>)
            temp_bitarray[i<span style="color:#f92672">*</span><span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> j] <span style="color:#f92672">=</span> (val <span style="color:#f92672">&gt;&gt;</span> (<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span>j)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>;
    }

    permutation(result, temp_bitarray, SPT, <span style="color:#ae81ff">32</span>);
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf <span style="color:#f92672">=</span> malloc(BUF_SIZE);
    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>key <span style="color:#f92672">=</span> malloc(BUF_SIZE);

    <span style="color:#66d9ef">char</span> left[<span style="color:#ae81ff">32</span>], right[<span style="color:#ae81ff">32</span>], tmp[<span style="color:#ae81ff">32</span>], round_result[<span style="color:#ae81ff">32</span>];
    <span style="color:#66d9ef">char</span> buf_bitarray[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> key_bitarray[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };

    <span style="color:#66d9ef">char</span> ip_array[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> result[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };
    <span style="color:#66d9ef">char</span> round_key[<span style="color:#ae81ff">16</span>][<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, };

    printf(<span style="color:#e6db74">&#34;Input Message ( 8 Bytes ): &#34;</span>);
    fgets(buf, BUF_SIZE, stdin);
    buf[strlen(buf) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\0&#39;</span>;
    char2bitarray(buf_bitarray, buf);
    
    printf(<span style="color:#e6db74">&#34;Input Key ( 8 Bytes ): &#34;</span>);
    fgets(key, BUF_SIZE, stdin);
    key[strlen(key) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\0&#39;</span>;
    char2bitarray(key_bitarray, key);

    <span style="color:#75715e">// initial permutation
</span><span style="color:#75715e"></span>    permutation(ip_array, buf_bitarray, IPT, <span style="color:#ae81ff">64</span>);
    key_generation(round_key, key_bitarray);

    memcpy(left, ip_array, <span style="color:#ae81ff">32</span>);
    memcpy(right, <span style="color:#f92672">&amp;</span>ip_array[<span style="color:#ae81ff">32</span>], <span style="color:#ae81ff">32</span>);

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
        round_f(round_result, right, round_key[i]);

        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; n <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; n<span style="color:#f92672">++</span>) {
            left[n] <span style="color:#f92672">^=</span>  round_result[n];
        }

        memcpy(tmp, left, <span style="color:#ae81ff">32</span>);
        memcpy(left, right, <span style="color:#ae81ff">32</span>);
        memcpy(right, tmp, <span style="color:#ae81ff">32</span>);
    }
    
    memcpy(ip_array, right, <span style="color:#ae81ff">32</span>);
    memcpy(<span style="color:#f92672">&amp;</span>ip_array[<span style="color:#ae81ff">32</span>], left, <span style="color:#ae81ff">32</span>);

    <span style="color:#75715e">// final permutation
</span><span style="color:#75715e"></span>    permutation(result, ip_array, FPT, <span style="color:#ae81ff">64</span>);
    printf(<span style="color:#e6db74">&#34;Encrypted : %lu</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, bitarray2integer(result, <span style="color:#ae81ff">64</span>));
    printf(<span style="color:#e6db74">&#34;hex(Encrypted) : %lx&#34;</span>, bitarray2integer(result, <span style="color:#ae81ff">64</span>));
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>To improve algorithm skills and coding skills, I will implement several Encryption scheme, such as aes, in c.</p>
<p>Also, optimizing these codes is one of the goals.</p>

  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  mhibio 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/post">Writings</a></li>
         
        <li><a href="/whoami">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
